import { RouteBases } from '../constants/api.mjs';
import 'lodash';

async function fetchServerIcon(ip) {
  const url = `${RouteBases.mcsrvstat}/icon/${ip}`;
  const response = await fetch(url);
  if (!response.ok) {
    const { statusText, status } = response;
    return { success: false, error: statusText, code: status };
  }
  const arrayBuffer = await response.arrayBuffer();
  return {
    success: true,
    data: {
      buffer: Buffer.from(arrayBuffer),
      url: response.url,
      response
    }
  };
}

export { fetchServerIcon };
