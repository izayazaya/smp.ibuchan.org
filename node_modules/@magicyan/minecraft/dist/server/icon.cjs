'use strict';

const api = require('../constants/api.cjs');
require('lodash');

async function fetchServerIcon(ip) {
  const url = `${api.RouteBases.mcsrvstat}/icon/${ip}`;
  const response = await fetch(url);
  if (!response.ok) {
    const { statusText, status } = response;
    return { success: false, error: statusText, code: status };
  }
  const arrayBuffer = await response.arrayBuffer();
  return {
    success: true,
    data: {
      buffer: Buffer.from(arrayBuffer),
      url: response.url,
      response
    }
  };
}

exports.fetchServerIcon = fetchServerIcon;
