'use strict';

const api = require('../constants/api.cjs');
const result = require('../helpers/result.cjs');
const utils = require('../helpers/utils.cjs');
require('lodash');

async function fetchMinecraftProfileSession(UUID) {
  const route = `session/minecraft/profile/${UUID}`;
  const url = `${api.RouteBases.sessionmojang}/${route}`;
  const response = await fetch(url);
  if (!response.ok)
    return result.notOkResult(response);
  const data = await response.json();
  const properties = data.properties.map((d) => utils.decodeBase64Json(d.value));
  data.properties = properties;
  return { success: true, data };
}

exports.fetchMinecraftProfileSession = fetchMinecraftProfileSession;
