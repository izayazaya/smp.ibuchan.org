import { RouteBases } from '../constants/api.mjs';
import { notOkResult } from '../helpers/result.mjs';
import { decodeBase64Json } from '../helpers/utils.mjs';
import 'lodash';

async function fetchMinecraftProfileSession(UUID) {
  const route = `session/minecraft/profile/${UUID}`;
  const url = `${RouteBases.sessionmojang}/${route}`;
  const response = await fetch(url);
  if (!response.ok)
    return notOkResult(response);
  const data = await response.json();
  const properties = data.properties.map((d) => decodeBase64Json(d.value));
  data.properties = properties;
  return { success: true, data };
}

export { fetchMinecraftProfileSession };
