import { RouteBases } from '../constants/api.mjs';
import { notOkResult } from '../helpers/result.mjs';
import { convertKeysToCamelCase } from '../helpers/format.mjs';
import 'lodash';

async function fetchMushPlayerInfo(nickOrUUID) {
  const url = `${RouteBases.mush}/player/${nickOrUUID}`;
  const response = await fetch(url);
  if (!response.ok)
    return notOkResult(response);
  const data = await response.json();
  if (!data.success) {
    return {
      success: data.success,
      code: data.error_code,
      error: data.response.message
    };
  }
  const info = convertKeysToCamelCase(data.response);
  return { success: true, data: info };
}

export { fetchMushPlayerInfo };
