'use strict';

const api = require('../constants/api.cjs');
const result = require('../helpers/result.cjs');
const format = require('../helpers/format.cjs');
require('lodash');

async function fetchMushPlayerInfo(nickOrUUID) {
  const url = `${api.RouteBases.mush}/player/${nickOrUUID}`;
  const response = await fetch(url);
  if (!response.ok)
    return result.notOkResult(response);
  const data = await response.json();
  if (!data.success) {
    return {
      success: data.success,
      code: data.error_code,
      error: data.response.message
    };
  }
  const info = format.convertKeysToCamelCase(data.response);
  return { success: true, data: info };
}

exports.fetchMushPlayerInfo = fetchMushPlayerInfo;
